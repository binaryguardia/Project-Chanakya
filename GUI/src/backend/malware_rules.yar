rule Suspicious_Strings
{
    meta:
        description = "Detects strings commonly found in malware"
        author = "Team Cyber Swipe"
        date = "2023-04-14"
    
    strings:
        $s1 = "cmd.exe" nocase
        $s2 = "powershell.exe" nocase
        $s3 = "rundll32.exe" nocase
        $s4 = "regsvr32.exe" nocase
        $s5 = "shell32.dll" nocase
        $s6 = "WScript.Shell" nocase
        $s7 = "CreateRemoteThread" nocase
        $s8 = "VirtualAlloc" nocase
        $s9 = "WriteProcessMemory" nocase

    condition:
        3 of them
}

rule Suspicious_File_Extensions
{
    meta:
        description = "Detects suspicious file extensions often used by malware"
        author = "Team Cyber Swipe"
        date = "2023-04-14"

    strings:
        $ext1 = ".exe" nocase
        $ext2 = ".dll" nocase
        $ext3 = ".scr" nocase
        $ext4 = ".bat" nocase
        $ext5 = ".cmd" nocase
        $ext6 = ".ps1" nocase
        $ext7 = ".vbs" nocase

    condition:
        any of them
}

rule Potential_Encryption_Functions
{
    meta:
        description = "Detects potential encryption function names"
        author = "Team Cyber Swipe"
        date = "2023-04-14"

    strings:
        $enc1 = "AES" nocase
        $enc2 = "Rijndael" nocase
        $enc3 = "Blowfish" nocase
        $enc4 = "RC4" nocase
        $enc5 = "DES" nocase
        $enc6 = "RSA" nocase

    condition:
        2 of them
}

rule Suspicious_Network_Activity
{
    meta:
        description = "Detects strings related to suspicious network activity"
        author = "Team Cyber Swipe"
        date = "2023-04-14"

    strings:
        $net1 = "http://" nocase
        $net2 = "https://" nocase
        $net3 = "ftp://" nocase
        $net4 = "socket" nocase
        $net5 = "connect" nocase
        $net6 = "download" nocase
        $net7 = "upload" nocase

    condition:
        3 of them
}

rule Potential_Obfuscation
{
    meta:
        description = "Detects potential obfuscation techniques"
        author = "Team Cyber Swipe"
        date = "2023-04-14"

    strings:
        $ob1 = "eval" nocase
        $ob2 = "base64" nocase
        $ob3 = "fromCharCode" nocase
        $ob4 = "escape" nocase
        $ob5 = "unescape" nocase

    condition:
        2 of them
}

rule Potential_Keylogger
{
    meta:
        description = "Detects potential keylogging activity"
        author = "Team Cyber Swipe"
        date = "2023-04-14"

    strings:
        $k1 = "GetAsyncKeyState" nocase
        $k2 = "GetKeyboardState" nocase
        $k3 = "keylog" nocase
        $k4 = "keyboard hook" nocase

    condition:
        2 of them
}

rule Potential_Rootkit
{
    meta:
        description = "Detects potential rootkit activity"
        author = "Team Cyber Swipe"
        date = "2023-04-14"

    strings:
        $r1 = "ZwQuerySystemInformation" nocase
        $r2 = "ZwQueryDirectoryFile" nocase
        $r3 = "ZwQueryInformationProcess" nocase
        $r4 = "NtQuerySystemInformation" nocase

    condition:
        2 of them
}

rule Suspicious_Registry_Access
{
    meta:
        description = "Detects suspicious registry access"
        author = "Team Cyber Swipe"
        date = "2023-04-14"

    strings:
        $reg1 = "RegOpenKeyEx" nocase
        $reg2 = "RegSetValueEx" nocase
        $reg3 = "RegCreateKeyEx" nocase
        $reg4 = "HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run" nocase

    condition:
        2 of them
}

rule Potential_Process_Injection
{
    meta:
        description = "Detects potential process injection techniques"
        author = "Team Cyber Swipe"
        date = "2023-04-14"

    strings:
        $inj1 = "VirtualAllocEx" nocase
        $inj2 = "WriteProcessMemory" nocase
        $inj3 = "CreateRemoteThread" nocase
        $inj4 = "NtCreateThreadEx" nocase

    condition:
        2 of them
}

rule Suspicious_File_Operations
{
    meta:
        description = "Detects suspicious file operations"
        author = "Team Cyber Swipe"
        date = "2023-04-14"

    strings:
        $file1 = "CreateFile" nocase
        $file2 = "WriteFile" nocase
        $file3 = "CopyFile" nocase
        $file4 = "MoveFile" nocase
        $file5 = "DeleteFile" nocase

    condition:
        3 of them
}

rule Potential_Ransomware
{
    meta:
        description = "Detects potential ransomware activity"
        author = "Team Cyber Swipe"
        date = "2023-04-14"

    strings:
        $ransom1 = "encrypt" nocase
        $ransom2 = "decrypt" nocase
        $ransom3 = "bitcoin" nocase
        $ransom4 = "ransom" nocase
        $ransom5 = "payment" nocase

    condition:
        3 of them
}

rule Suspicious_PowerShell_Commands
{
    meta:
        description = "Detects suspicious PowerShell commands"
        author = "Team Cyber Swipe"
        date = "2023-04-14"

    strings:
        $ps1 = "Invoke-Expression" nocase
        $ps2 = "IEX" nocase
        $ps3 = "New-Object Net.WebClient" nocase
        $ps4 = "DownloadString" nocase
        $ps5 = "EncodedCommand" nocase

    condition:
        2 of them
}

rule Potential_Credential_Dumping
{
    meta:
        description = "Detects potential credential dumping activity"
        author = "Team Cyber Swipe"
        date = "2023-04-14"

    strings:
        $cred1 = "lsass.exe" nocase
        $cred2 = "mimikatz" nocase
        $cred3 = "sekurlsa::" nocase
        $cred4 = "kerberos::" nocase
        $cred5 = "wdigest" nocase

    condition:
        2 of them
}